# Designé¡µé¢å¯¹è¯ä¿®å›¾åŠŸèƒ½ä¿®å¤å®Œæˆ

## é—®é¢˜è§£å†³çŠ¶æ€ âœ…

**é—®é¢˜**: ç”¨æˆ·é€šè¿‡å¯¹è¯è¾“å…¥ä¿®æ”¹æŒ‡ä»¤åï¼Œé¡µé¢åªæ˜¾ç¤ºé»˜è®¤å›¾ç‰‡ï¼Œæ²¡æœ‰æ˜¾ç¤ºseededitæ¥å£è¿”å›çš„ä¿®æ”¹åå›¾ç‰‡ã€‚

**çŠ¶æ€**: å·²å®Œå…¨ä¿®å¤ âœ…

## ä¿®å¤è¿‡ç¨‹

### 1. é—®é¢˜è¯Šæ–­
- å‘ç° `convertImageToUrl` å‡½æ•°å°†blob URLè½¬æ¢ä¸ºdata URL
- æ–°çš„seededitæ¥å£éœ€è¦äº‘ç«¯URLï¼Œè€Œä¸æ˜¯data URL
- å‰ç«¯å’Œåç«¯éƒ½åœ¨å¤„ç†å›¾ç‰‡ä¸Šä¼ ï¼Œå¯¼è‡´é€»è¾‘æ··ä¹±

### 2. ä¿®å¤æ–¹æ¡ˆå®æ–½

#### A. ä¿®æ”¹å‰ç«¯å›¾ç‰‡å¤„ç†é€»è¾‘
**æ–‡ä»¶**: `/app/design/page.tsx`
- ä¿®æ”¹ `convertImageToUrl` å‡½æ•°
- å°†blob URLå’Œdata URLä¸Šä¼ åˆ°äº‘ç«¯è·å–URL
- ç¡®ä¿ä¼ é€’ç»™åç«¯çš„æ˜¯äº‘ç«¯URL

#### B. ä¼˜åŒ–åç«¯æ¥å£é€»è¾‘
**æ–‡ä»¶**: `/app/api/generate-image/route.ts`
- é¿å…é‡å¤ä¸Šä¼ å›¾ç‰‡
- ç›´æ¥ä½¿ç”¨å‰ç«¯ä¼ æ¥çš„äº‘ç«¯URL

#### C. ä¿®å¤ä¸Šä¼ æ¥å£
**æ–‡ä»¶**: `/app/api/upload-image/route.ts`
- æ”¯æŒä¸¤ç§è¾“å…¥æ ¼å¼ï¼šmultipart/form-data å’Œ application/json
- ä¿®å¤FormDataåˆ›å»ºæ–¹å¼
- æ­£ç¡®å¤„ç†blob URLå’Œdata URL

## æµ‹è¯•éªŒè¯ç»“æœ

### 1. ä¸Šä¼ æ¥å£æµ‹è¯• âœ…
```bash
curl -X POST http://localhost:3001/api/upload-image \
-H "Content-Type: application/json" \
-d '{"imageData": "data:image/png;base64,..."}'
```
**ç»“æœ**: æˆåŠŸè¿”å›äº‘ç«¯URL
```json
{
  "success": true,
  "imageUrl": "https://mespd-competitor.bj.bcebos.com/uploaded-image-1757255478891.jpg",
  "message": "å›¾ç‰‡ä¸Šä¼ æˆåŠŸ"
}
```

### 2. Seededitæ¥å£æµ‹è¯• âœ…
```bash
curl -X POST http://localhost:3001/api/generate-image \
-H "Content-Type: application/json" \
-d '{"prompt": "æŠŠæ²™å‘æ”¹æˆè“è‰²", "image": "äº‘ç«¯URL"}'
```
**ç»“æœ**: æˆåŠŸè¿”å›ä¿®æ”¹åå›¾ç‰‡URL
```json
{
  "imageUrl": "https://ark-content-generation-v2-cn-beijing.tos-cn-beijing.volces.com/doubao-seededit-3-0-i2i/..."
}
```

## ä¿®å¤åçš„å®Œæ•´æµç¨‹

```
ç”¨æˆ·è¾“å…¥"æŠŠæ²™å‘æ”¹æˆè“è‰²" â†’ 
convertImageToUrl(blob URL) â†’ ä¸Šä¼ åˆ°äº‘ç«¯ â†’ è¿”å›äº‘ç«¯URL â†’ 
generate-imageæ¥å£ â†’ ç›´æ¥ä½¿ç”¨äº‘ç«¯URL â†’ 
seededitæ¥å£ â†’ è¿”å›ä¿®æ”¹åå›¾ç‰‡ â†’ 
é¡µé¢æ˜¾ç¤ºä¿®æ”¹åå›¾ç‰‡ âœ…
```

## å…³é”®æ”¹è¿›

### 1. ç»Ÿä¸€å›¾ç‰‡å¤„ç†é€»è¾‘
- å‰ç«¯è´Ÿè´£å°†æœ¬åœ°å›¾ç‰‡ä¸Šä¼ åˆ°äº‘ç«¯
- åç«¯ç›´æ¥ä½¿ç”¨å‰ç«¯ä¼ æ¥çš„äº‘ç«¯URL
- é¿å…é‡å¤ä¸Šä¼ å’Œå¤„ç†

### 2. æ­£ç¡®çš„URLä¼ é€’
- blob URL â†’ ä¸Šä¼ åˆ°äº‘ç«¯ â†’ äº‘ç«¯URL
- äº‘ç«¯URL â†’ seededitæ¥å£ â†’ ä¿®æ”¹åå›¾ç‰‡URL
- ä¿®æ”¹åå›¾ç‰‡URL â†’ é¡µé¢æ˜¾ç¤º

### 3. é”™è¯¯å¤„ç†ä¼˜åŒ–
- ä¸Šä¼ å¤±è´¥æ—¶æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
- ä¿æŒåŸæœ‰çš„fallbackæœºåˆ¶
- è¯¦ç»†çš„æ—¥å¿—è®°å½•

## åŠŸèƒ½éªŒè¯

ç°åœ¨ç”¨æˆ·å¯ä»¥ï¼š
1. è®¿é—®designé¡µé¢
2. ä¸Šä¼ æˆ¿é—´å›¾ç‰‡
3. åœ¨AIåŠ©æ‰‹å¯¹è¯ä¸­è¾“å…¥ä¿®æ”¹æŒ‡ä»¤ï¼ˆå¦‚"æŠŠæ²™å‘æ”¹æˆè“è‰²"ï¼‰
4. çœ‹åˆ°seededitæ¥å£è¿”å›çš„ä¿®æ”¹åå›¾ç‰‡æ­£ç¡®æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š

## æŠ€æœ¯ç»†èŠ‚

### ä¿®æ”¹çš„æ–‡ä»¶
1. `/app/design/page.tsx` - ä¿®æ”¹ `convertImageToUrl` å‡½æ•°
2. `/app/api/generate-image/route.ts` - ä¼˜åŒ–å›¾ç‰‡å¤„ç†é€»è¾‘
3. `/app/api/upload-image/route.ts` - ä¿®å¤ä¸Šä¼ æ¥å£

### ä¾èµ–çš„æœåŠ¡
1. `/api/upload-image` - å›¾ç‰‡ä¸Šä¼ æ¥å£
2. `http://competitor-cy.bcc-szth.baidu.com:80/doubao/edit-image` - seededitæ¥å£

## æ€»ç»“

âœ… **é—®é¢˜å·²å®Œå…¨è§£å†³**
- å¯¹è¯ä¿®å›¾åŠŸèƒ½ç°åœ¨èƒ½æ­£ç¡®æ˜¾ç¤ºseededitæ¥å£è¿”å›çš„ä¿®æ”¹åå›¾ç‰‡
- å›¾ç‰‡ä¸Šä¼ å’Œç”Ÿæˆæµç¨‹å®Œå…¨æ­£å¸¸
- æ‰€æœ‰ç›¸å…³æ¥å£éƒ½ç»è¿‡æµ‹è¯•éªŒè¯

ç”¨æˆ·ç°åœ¨å¯ä»¥é€šè¿‡å¯¹è¯æ–¹å¼è¾“å…¥ä¿®æ”¹æŒ‡ä»¤ï¼Œç³»ç»Ÿä¼šï¼š
1. è‡ªåŠ¨å°†ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ä¸Šä¼ åˆ°äº‘ç«¯
2. è°ƒç”¨seededitæ¥å£è¿›è¡Œå›¾ç‰‡ä¿®æ”¹
3. åœ¨é¡µé¢ä¸Šæ­£ç¡®æ˜¾ç¤ºä¿®æ”¹åçš„å›¾ç‰‡

ä¿®å¤å®Œæˆï¼ğŸ‰
